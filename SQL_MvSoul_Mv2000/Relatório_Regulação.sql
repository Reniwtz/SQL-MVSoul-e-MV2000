-- Consultas Especializadas   
SELECT
    to_char(atendime.dt_atendimento, 'MON', 'NLS_DATE_LANGUAGE=PORTUGUESE') AS mes_atend,
    COUNT(*) AS consultas_especializadas
FROM
    atendime
WHERE
    dt_atendimento BETWEEN TO_DATE('01/01/2023', 'DD/MM/YYYY') AND TO_DATE('31/08/2023', 'DD/MM/YYYY')
    AND cd_procedimento LIKE '0301010048'
  --AND cd_procedimento LIKE '0301010072'
    AND cd_convenio LIKE '2'
GROUP BY
    to_char(atendime.dt_atendimento, 'MON', 'NLS_DATE_LANGUAGE=PORTUGUESE')
ORDER BY
    TO_DATE(mes_atend, 'MON', 'NLS_DATE_LANGUAGE=PORTUGUESE');

--------------------------------------------------------------------------------------------

--Patologia regulação
SELECT
    --exa_rx.cd_exa_rx,
    exa_rx.ds_exa_rx,
    exa_rx.cd_procedimento_sia,
    COUNT(*)
FROM
    exa_rx   exa_rx,
    itped_rx itped_rx
WHERE
    cd_procedimento_sia IN ( 0201010020, 0201010046, 0201010194, 0201010232, 0201010275,
                             0201010321, 0201010372, 0201010380, 0201010410, 0201010470,
                             0201010518, 0201010526, 0201010569, 0201010631, 0203010019,
                             0203010035, 0203010086, 0203010043, 0203020014, 0203020030,
                             0203020049, 0203020081 )
    AND itped_rx.dt_realizado BETWEEN TO_DATE('01/01/2023', 'DD/MM/YYYY') AND TO_DATE('31/01/2023', 'DD/MM/YYYY')
    AND exa_rx.cd_exa_rx = itped_rx.cd_exa_rx
GROUP BY
    exa_rx.cd_exa_rx,
    exa_rx.cd_procedimento_sia,
    exa_rx.ds_exa_rx
ORDER BY
    exa_rx.cd_procedimento_sia

-------------------------------------------------------------------------------------------

--Quimio e Ambulatório
SELECT
    cd_procedimento,
    count
FROM
    atendime
WHERE
    cd_procedimento IN ( 0201010020, 0201010046, 0201010194, 0201010232, 0201010275,
                         0201010321, 0201010372, 0201010380, 0201010410, 0201010470,
                         0201010518, 0201010526, 0201010569, 0201010631, 0203010019,
                         0203010035, 0203010086, 0203010043, 0203020014, 0203020030,
                         0203020049, 0203020081, 0211020036, 0211070017, 0211070033,
                         0211070041, 0211070050, 0211070068, 0211070076, 0211070084,
                         0211070114, 0211070149, 0211070157, 0211070203, 0211070211,
                         0211070262, 0301010048, 0301010056, 0301010072, 0301060029,
                         0301060061, 0301070113, 0301070024, 0302020039, 0302020012,
                         0302040013, 0302040021, 0401010015, 0404010121, 0404020097,
                         0406020205, 0407040196, 0701030356, 0303020016, 0304020010,
                         0304020028, 0304020036, 0304020044, 0304020052, 0304020060,
                         0304020079, 0304020087, 0304020095, 0304020109, 0304020117,
                         0304020125, 0304020133, 0304020141, 0304020150, 0304020168,
                         0304020176, 0304020184, 0304020192, 0304020206, 0304020214,
                         0304020222, 0304020230, 0304020249, 0304020257, 0304020265,
                         0304020273, 0304020281, 0304020290, 0304020303, 0304020311,
                         0304020320, 0304020338, 0304020346, 0304020362, 0304020370,
                         0304020389, 0304020397, 0304020400, 0304020419, 0304020427,
                         0304020435, 0304020443, 0304030015, 0304030023, 0304030031,
                         0304030040, 0304030058, 0304030066, 0304030074, 0304030082,
                         0304030090, 0304030104, 0304030112, 0304030120, 0304030139,
                         0304030147, 0304030155, 0304030163, 0304030171, 0304030180,
                         0304030198, 0304030201, 0304030210, 0304030228, 0304030236,
                         0304030244, 0304040010, 0304040029, 0304040045, 0304040053,
                         0304040061, 0304040070, 0304040088, 0304040096, 0304040100,
                         0304040118, 0304040126, 0304040134, 0304040142, 0304040169,
                         0304040177, 0304040185, 0304040193, 0304040207, 0304050016,
                         0304050024, 0304050032, 0304050040, 0304050067, 0304050075,
                         0304050113, 0304050121, 0304050130, 0304050172, 0304050180,
                         0304050202, 0304050210, 0304050229, 0304050253, 0304050261,
                         0304050270, 0304050288, 0304050296, 0304050300, 0304050318,
                         0304050326, 0304050334, 0304050342, 0304060011, 0304060038,
                         0304060046, 0304060070, 0304060089, 0304060097, 0304060100,
                         0304060119, 0304060127, 0304060135, 0304060151, 0304060160,
                         0304060178, 0304060186, 0304060208, 0304060216, 0304060224,
                         0304060232, 0304060240, 0304070017, 0304070025, 0304070041,
                         0304070050, 0334070068, 0304070076, 0304080012, 0304080055,
                         0304080071, 0304030252, 0304030260 )
    AND dt_atendimento BETWEEN TO_DATE('01/01/2022', 'DD/MM/YYYY') AND TO_DATE('31/01/2022', 'DD/MM/YYYY')
GROUP BY
    cd_procedimento
ORDER BY
    cd_procedimento
