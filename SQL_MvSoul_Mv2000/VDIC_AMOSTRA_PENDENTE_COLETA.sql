CREATE OR REPLACE VIEW VDIC_AMOSTRA_PENDENTE_COLETA AS
SELECT
DISTINCT(AMOSTRA.cd_amostra) cd_amostra,
ITPED_LAB.CD_PED_LAB,
AMOSTRA.cd_tubo_coleta,
TUBO_COLETA.DS_TUBO_COLETA,
AMOSTRA.cd_material,
MATERIAL.DS_MATERIAL
  FROM dbamv.ITPED_LAB
  INNER JOIN DBAMV.EXA_LAB_MATERIAL ON (ITPED_LAB.CD_EXA_LAB = EXA_LAB_MATERIAL.CD_EXA_LAB)
  INNER JOIN DBAMV.AMOSTRA ON (AMOSTRA.CD_MATERIAL = EXA_LAB_MATERIAL.CD_MATERIAL AND AMOSTRA.CD_TUBO_COLETA = EXA_LAB_MATERIAL.CD_TUBO_COLETA)
  INNER JOIN DBAMV.AMOSTRA_EXA_LAB ON (AMOSTRA_EXA_LAB.CD_ITPED_LAB = ITPED_LAB.CD_ITPED_LAB AND AMOSTRA_EXA_LAB.CD_AMOSTRA = AMOSTRA.CD_AMOSTRA)
  INNER JOIN DBAMV.TUBO_COLETA ON (AMOSTRA.CD_TUBO_COLETA = TUBO_COLETA.CD_TUBO_COLETA)
  INNER JOIN DBAMV.MATERIAL ON (AMOSTRA.CD_MATERIAL = MATERIAL.CD_MATERIAL)
 WHERE ITPED_LAB.SN_COLETA_PENDENTE = 'S';
